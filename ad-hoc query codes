# üìä SQL Queries - Business Intelligence Analysis

This document contains all SQL queries used to analyze the Atliq Hardware dataset. Each query addresses a specific business question and delivers actionable insights.

---

## üåè Query 1: Market Penetration in APAC Region

### Business Question
Provide the list of markets in which customer **"Atliq Exclusive"** operates its business in the **APAC** region.

### Key Insights
- Identifies regional market presence
- Helps understand geographical distribution
- Supports market expansion strategy

### SQL Query
```sql
SELECT DISTINCT(market)
FROM dim_customer
WHERE customer = 'Atliq Exclusive'
  AND region = 'APAC';
```

### Output Fields
- `market` - List of markets in APAC region

---

## üìà Query 2: Year-over-Year Product Growth Analysis

### Business Question
What is the percentage of unique product increase in **2021 vs. 2020**?

### Key Insights
- Measures product portfolio expansion
- Tracks innovation and product development pace
- Indicates business growth trajectory

### SQL Query
```sql
WITH count2020 AS (
    SELECT COUNT(DISTINCT s.product_code) AS unique_product_2020
    FROM fact_sales_monthly s
    WHERE s.fiscal_year = 2020
),
count2021 AS (
    SELECT COUNT(DISTINCT s.product_code) AS unique_product_2021
    FROM fact_sales_monthly s
    WHERE s.fiscal_year = 2021
)
SELECT 
    c1.unique_product_2020,
    c2.unique_product_2021,
    ROUND(
        ((c2.unique_product_2021 - c1.unique_product_2020) * 100.0) / 
        NULLIF(c1.unique_product_2020, 0),
        2
    ) AS percentage_chg
FROM count2020 c1
CROSS JOIN count2021 c2;
```

### Output Fields
- `unique_products_2020` - Total unique products in 2020
- `unique_products_2021` - Total unique products in 2021
- `percentage_chg` - Growth percentage

---

## üéØ Query 3: Product Distribution by Segment

### Business Question
Provide a report with all the **unique product counts** for each segment and sort them in descending order of product counts.

### Key Insights
- Identifies high-volume product segments
- Reveals product portfolio concentration
- Guides inventory and resource allocation

### SQL Query
```sql
SELECT 
    p.segment,
    COUNT(DISTINCT p.product_code) AS product_count
FROM dim_product p
GROUP BY p.segment
ORDER BY product_count DESC;
```

### Output Fields
- `segment` - Product segment name
- `product_count` - Number of unique products

---

## üöÄ Query 4: Segment Growth Leader Identification

### Business Question
Which segment had the **most increase** in unique products in **2021 vs 2020**?

### Key Insights
- Identifies fastest-growing segments
- Highlights successful product categories
- Informs future investment decisions

### SQL Query
```sql
WITH count2020 AS (
    SELECT 
        p.segment,
        COUNT(DISTINCT s.product_code) AS unique_product_2020
    FROM fact_sales_monthly s
    JOIN dim_product p ON s.product_code = p.product_code
    WHERE s.fiscal_year = 2020
    GROUP BY p.segment
),
count2021 AS (
    SELECT 
        p.segment,
        COUNT(DISTINCT s.product_code) AS unique_product_2021
    FROM fact_sales_monthly s
    JOIN dim_product p ON s.product_code = p.product_code
    WHERE s.fiscal_year = 2021
    GROUP BY p.segment
)
SELECT 
    c1.segment,
    c1.unique_product_2020,
    COALESCE(c2.unique_product_2021, 0) AS unique_product_2021,
    COALESCE(c2.unique_product_2021, 0) - c1.unique_product_2020 AS difference
FROM count2020 c1
LEFT JOIN count2021 c2 ON c1.segment = c2.segment
ORDER BY difference DESC;
```

### Output Fields
- `segment` - Product segment name
- `product_count_2020` - Unique products in 2020
- `product_count_2021` - Unique products in 2021
- `difference` - Absolute growth in product count

---

## üí∞ Query 5: Manufacturing Cost Extremes

### Business Question
Get the products that have the **highest and lowest manufacturing costs**.

### Key Insights
- Identifies cost outliers for optimization
- Supports pricing strategy decisions
- Highlights premium vs. budget products

### SQL Query
```sql
SELECT 
    p.product_code,
    p.product,
    ROUND(SUM(m.manufacturing_cost), 2) AS manufacturing_cost
FROM dim_product p
JOIN fact_manufacturing_cost m ON p.product_code = m.product_code
GROUP BY p.product_code, p.product
ORDER BY manufacturing_cost DESC;
```

### Output Fields
- `product_code` - Unique product identifier
- `product` - Product name
- `manufacturing_cost` - Total manufacturing cost

---

## üéÅ Query 6: Top Discounted Customers in India

### Business Question
Generate a report which contains the **top 5 customers** who received an average high **pre_invoice_discount_pct** for the **fiscal year 2021** in the **Indian** market.

### Key Insights
- Identifies high-value customer relationships
- Evaluates discount strategy effectiveness
- Supports customer retention planning

### SQL Query
```sql
SELECT 
    c.customer_code,
    c.customer,
    ROUND(AVG(p.pre_invoice_discount_pct) * 100, 2) AS average_discount_percentage
FROM dim_customer c
JOIN fact_pre_invoice_deductions p ON c.customer_code = p.customer_code
WHERE p.fiscal_year = 2021
  AND c.market = 'India'
GROUP BY c.customer_code, c.customer
ORDER BY average_discount_percentage DESC
LIMIT 5;
```

### Output Fields
- `customer_code` - Unique customer identifier
- `customer` - Customer name
- `average_discount_percentage` - Average discount (%)

---

## üìÖ Query 7: Monthly Sales Performance for Atliq Exclusive

### Business Question
Get the complete report of the **Gross sales amount** for the customer **"Atliq Exclusive"** for each month. This analysis helps to get an idea of low and high-performing months and take strategic decisions.

### Key Insights
- Reveals seasonal sales patterns
- Identifies peak and off-peak months
- Guides promotional campaign timing

### SQL Query
```sql
WITH monthly_sales AS (
    SELECT 
        MONTHNAME(f.date) AS month_name,
        f.fiscal_year,
        ROUND(SUM(g.gross_price * f.sold_quantity), 2) AS gross_sales_amount
    FROM fact_sales_monthly f
    JOIN fact_gross_price g ON f.product_code = g.product_code
    JOIN dim_customer c ON c.customer_code = f.customer_code
    WHERE c.customer = 'Atliq Exclusive'
    GROUP BY month_name, f.fiscal_year
)
SELECT 
    month_name AS Month,
    fiscal_year AS Year,
    gross_sales_amount AS Gross_Sales_Amount
FROM monthly_sales
ORDER BY fiscal_year, gross_sales_amount DESC;
```

### Output Fields
- `Month` - Month name
- `Year` - Fiscal year
- `Gross_Sales_Amount` - Total gross sales in USD

---

## üóìÔ∏è Query 8: Best Performing Quarter in 2020

### Business Question
In which quarter of **2020**, got the **maximum total_sold_quantity**?

### Key Insights
- Identifies peak demand periods
- Supports inventory planning
- Reveals seasonal business patterns

### SQL Query
```sql
SELECT 
    CASE
        WHEN MONTH(date) IN (1, 2, 3) THEN 'Q1'
        WHEN MONTH(date) IN (4, 5, 6) THEN 'Q2'
        WHEN MONTH(date) IN (7, 8, 9) THEN 'Q3'
        WHEN MONTH(date) IN (10, 11, 12) THEN 'Q4'
    END AS Quarter,
    SUM(sold_quantity) AS total_sold_quantity
FROM fact_sales_monthly
WHERE fiscal_year = 2020
GROUP BY Quarter
ORDER BY total_sold_quantity DESC
LIMIT 1;
```

### Output Fields
- `Quarter` - Fiscal quarter (Q1-Q4)
- `total_sold_quantity` - Total units sold

---

## üì¢ Query 9: Channel Performance Analysis

### Business Question
Which **channel** helped to bring more **gross sales** in the **fiscal year 2021** and the **percentage of contribution**?

### Key Insights
- Evaluates channel effectiveness
- Optimizes marketing budget allocation
- Guides omnichannel strategy

### SQL Query
```sql
WITH channel_sales AS (
    SELECT 
        c.channel,
        ROUND(SUM(s.sold_quantity * g.gross_price) / 1000000, 2) AS gross_sales_mln
    FROM dim_customer c
    JOIN fact_sales_monthly s ON c.customer_code = s.customer_code
    JOIN fact_gross_price g ON g.product_code = s.product_code
    WHERE s.fiscal_year = 2021
    GROUP BY c.channel
)
SELECT 
    channel,
    gross_sales_mln,
    ROUND(gross_sales_mln * 100 / (SELECT SUM(gross_sales_mln) FROM channel_sales), 2) AS percentage
FROM channel_sales
ORDER BY percentage DESC;
```

### Output Fields
- `channel` - Sales channel (Retailer, Direct, Distributor)
- `gross_sales_mln` - Gross sales in millions
- `percentage` - Contribution percentage

---

## üèÜ Query 10: Top 3 Products per Division

### Business Question
Get the **Top 3 products** in each division that have a high **total_sold_quantity** in the **fiscal_year 2021**.

### Key Insights
- Identifies star performers by division
- Supports cross-division benchmarking
- Guides product promotion strategy

### SQL Query
```sql
WITH product_sales_2021 AS (
    SELECT 
        p.division,
        s.product_code,
        p.product,
        SUM(s.sold_quantity) AS total_sold_quantity
    FROM fact_sales_monthly s
    JOIN dim_product p ON s.product_code = p.product_code
    WHERE s.fiscal_year = 2021
    GROUP BY p.division, s.product_code, p.product
),
ranked_products AS (
    SELECT 
        division,
        product_code,
        product,
        total_sold_quantity,
        RANK() OVER (PARTITION BY division ORDER BY total_sold_quantity DESC) AS rank_order
    FROM product_sales_2021
)
SELECT 
    division,
    product_code,
    product,
    total_sold_quantity,
    rank_order
FROM ranked_products
WHERE rank_order <= 3
ORDER BY division, rank_order;
```

### Output Fields
- `division` - Product division (N&S, P&A, PC)
- `product_code` - Product identifier
- `product` - Product name
- `total_sold_quantity` - Total units sold
- `rank_order` - Rank within division (1-3)

---

## üõ†Ô∏è Technical Notes

### SQL Techniques Used
- **Common Table Expressions (CTEs)** - For modular, readable queries
- **Window Functions** - RANK(), PARTITION BY for advanced analytics
- **Aggregate Functions** - SUM(), COUNT(), AVG() for data summarization
- **JOINS** - Multiple table relationships for comprehensive analysis
- **CASE Statements** - Conditional logic for quarter calculations
- **Subqueries** - Nested queries for percentage calculations

### Database Information
- **Database Name:** `gdb023`
- **RDBMS:** MySQL 8.0+
- **Total Tables:** 6 (3 dimension tables, 3 fact tables)

---

<div align="center">

**üìä All queries have been tested and validated for accuracy**

*For questions or improvements, please open an issue*

</div>
